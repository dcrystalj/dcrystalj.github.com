<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Tomaž Tomažič"><link rel="shortcut icon" type=image/x-icon href=https://www.tomazic.pro/img/favicon.ico><title>One Mnemonic to Rule Them All: Unlocking the Power of BIP85 | dcrystalj</title><meta name=description content="In the vast landscape of cryptocurrency and blockchain technology, the importance of securely managing private keys cannot be overstated. The Bitcoin Improvement Proposal 85 (BIP85) has emerged as a game-changer, offering a single mnemonic phrase that can generate an array of different cryptocurrency keys. In this blog post, we will delve into the practicality and usefulness of BIP85, exploring how it simplifies key management and enhances security for crypto enthusiasts."><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl crossorigin=anonymous><link rel="preload stylesheet" href=/css/main.min.css as=style><link rel=stylesheet type=text/css href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet type=text/css href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old"><link rel=stylesheet href=/css/applause-button.css><script src=/js/applause-button.js></script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js></script>
<script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]-->
<link rel=stylesheet type=text/css href=https://www.tomazic.pro/css/vitae-skeleton.css><link rel=stylesheet type=text/css href=https://www.tomazic.pro/css/vitae-layout.css><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-LQJ8L15S31","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><div id=content><div class="container mb-3"><nav class="navbar navbar-expand-lg"><div class=container-fluid><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbar aria-controls=navbar>
<i class="fa fa-bars"></i></button><div id=navbar class="collapse navbar-collapse"><ul class="navbar-nav ms-auto mb-2 mb-lg-0"><li class=nav-item><li><a class=nav-link href=/blog/>BLOG</a></li></li><li class=nav-item><li><a class=nav-link href=/resume/>RESUME</a></li></li></ul></div></div></div></nav><div class=container><h3 class=mt-3><b><a href=https://www.tomazic.pro/blog/one-mnemonic-bip85/>One Mnemonic to Rule Them All: Unlocking the Power of BIP85</a></b></h3><div class="blog-title my-4"></div><div class=panel><div class=panel-body><div class=blogpost><p>Do you have multiple mnemonics written down on paper and you are afraid to mix or lose them in some catastrophic event? There exists a solution for that. <a href=https://github.com/bitcoin/bips/blob/master/bip-0085.mediawiki>BIP85</a> is a standard that allows you to deterministically derive new mnemonics or entropies from a single mnemonic phrase.</p><p>In this blog post, we will delve into the practicality and usefulness of BIP85, exploring how it simplifies key management and enhances security for crypto enthusiasts.</p><h1 id=bip85>BIP85</h1><p>Mnemonic words became quite standard for storing private keys. They are easy to write down and remember. Different wallets might use different standards to generate mnemonic words but all start with some &ldquo;initial entropy&rdquo; and then process the mnemonic into a BIP32 key, or private key. Derived BIP85 entropy is very similar to other standard tree derivation paths except that is uses deterministic random number to point to the specific node in the tree. The only thing you will need to know is the index of derived mnemonic. This can be safely stored in your password manager and even if you loose it, you can still bruteforce first 1000 indexes in quite reasonable time.</p><p>Securely storing mnemonic words is a great challenge on it&rsquo;s own. Having multiple of them is even more. Luckily there is no need for one person to store more than one mnemonic phrase because you can generate them as many as you want.</p><p>Lets say you have a cold storage wallet, hot wallet on mobile phone and lightning node. If you are not using BIP85 you would probably have 3 different mnemonic phrases to manage?</p><h1 id=tools-and-best-practices>Tools and Best Practices</h1><p>There are multiple tools online with which you can generate and test BIP85 by yourself. One of them is <a href=https://iancoleman.io/bip39/>iancoleman.io</a> or <a href=https://bitcoiner.guide/seed/>Seed Tool</a>. You can generate BIP85 mnemonic phrase by checking &ldquo;Show BIP85&rdquo; checkbox.
Of course don&rsquo;t you dare to enter your real mnemonic phrase into some online tool.</p><p>There are also several secure option to derive BIP85 mnemonic phrase.
The easiest is to use hardware wallet but most of the wallets don&rsquo;t have support for BIP85 yet (and looks like they never will). I know you can use <a href=https://coldcardwallet.com/>Coldcard</a>, <a href=https://blockstream.com/jade/>Jade</a> or <a href=https://github.com/SeedSigner/seedsigner>Seedsigner</a> to directly derive BIP85 mnemonic phrase offline. But what if you don&rsquo;t have any of these devices?</p><p>People will usually recommend you to boot into <a href=https://tails.boum.org/>tails</a> linux, load the needed tool and go offline. This still feels quite risky and if you are really paranoid you will have to destory computer afterwards. Not very practical IMO&mldr;</p><p>I have solved my problem by using old, half working raspberrypi (RPI) which doesn&rsquo;t have any wireless connectivity. My RPI cannot not load webbrowser but only terminal, so I wrote short <a href=https://github.com/dcrystalj/hdwd>python script</a> and I will never ever connect RPI to internet again, but I can still use it to derive BIP85 mnemonic phrase whenever I need to.</p><h1 id=core-lightning-and-lnd-derivation>Core lightning and LND derivation</h1><p>When generating wallet for core lighting you can use command <code>lightning-hsmtool generatehsm hsm_secret</code> which will offer you to write derived mnemonic before generating hsm_secret.</p><p>However for LND you will find out that plain derived mnemonic is not good enough because it requires <a href="https://walletsrecovery.org/#:~:text=Network%20Daemon)%E2%86%97%EF%B8%8E-,aezeed,-Optional">aezeed</a> format. Aezeed incorporates more data, like birthday and version into the mnemonic itself. For this kind of wallets you can still use BIP85 to derive new entropy (pick WIF from derived mnemonic), but you will have to convert it to aezeed format later.</p><p>If you are running LND node in umbrel, you can use the following commands to generate aezeed mnemonic phrase and then use &ldquo;recovery option&rdquo; on the first run.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>sudo docker <span style=color:#204a87>exec</span> -it lightning_app_1 bash
</span></span><span style=display:flex><span><span style=color:#204a87>cd</span> /app/apps/backend/utils <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> node
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#000;font-weight:700>.</span><span style=color:#000>load</span> <span style=color:#000>deterministic</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#000>aezeed</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>js</span>
</span></span><span style=display:flex><span><span style=color:#000>deterministicAezeed</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;write your WIF here&gt;&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p><a href=https://github.com/getumbrel/umbrel-lightning/blob/fc19335fc597c75bebd4612f939ba25f2b9eb919/apps/backend/utils/deterministic-aezeed.js#L4>Source</a></p><h1 id=conclusion>Conclusion:</h1><p>In the world of cryptocurrency, securely managing private keys is paramount. BIP85 offers a revolutionary approach to key management, simplifying the process while enhancing security. By utilizing a single mnemonic phrase, users can derive multiple keys across different wallets and cryptocurrencies, streamlining wallet management and reducing the risk of key loss. As we&rsquo;ve discovered, BIP85 is a powerful tool that empowers crypto enthusiasts to take control of their digital assets securely.</p><h1 id=resources>Resources</h1><ul><li><a href=https://github.com/bitcoin/bips/blob/master/bip-0085.mediawiki>BIP85</a> specification</li><li><a href=https://stephanlivera.com/episode/368/>SLP368 BITCOINQNA – BITCOIN SEED TOOL</a> podcast</li><li><a href=https://github.com/bitcoinbook/bitcoinbook>Mastering Bitcoin</a> by Andreas M. Antonopoulos</li></ul></div><div class=blogpost__footer>May 13, 2023
&nbsp;&nbsp;
<span class="badge bg-success">BIP85</span>
<span class="badge bg-success">bitcoin</span></div></div><div class=applause><applause-button class=applause__button url=https://www.tomazic.pro/blog/one-mnemonic-bip85/ color=#22a8a1></div><div class=disqus><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//dcrystalj.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></div><footer class=footer><div class=container><div class=text-muted>&copy; All rights reserved 2023</div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js integrity=sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG crossorigin=anonymous></script></body></html>